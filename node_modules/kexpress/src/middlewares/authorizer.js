'use strict';

const loggers = require('../lib/loggers');
const outputLogger = loggers.output;

function loginChecker(req, res, next) {
    if (!req.session.userName) {
        outputLogger.error(`Access forbidden from ${req.ip}`);
        res.status(403).send('Request refused');

        return;
    }

    next();
}

module.exports = {
    loginChecker: loginChecker
};
